<!DOCTYPE html> 
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<title>clLib Test</title> 
<!--	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />-->
		<link rel="stylesheet" href="css/jquery.mobile-1.3.0.min.css" />
		<link rel="stylesheet" href="css/clRouteColors.css" />

		<script type="text/javascript" src="js/clLib.js"></script>
		<script type="text/javascript" src="js/clLib.gradeConfig.js"></script>
		<script type="text/javascript" src="js/clLib.localStorage.js"></script>
		<script type="text/javascript" src="js/clLib.localStorage.indexes.js"></script>
		<script type="text/javascript" src="js/clLib.UI.js"></script>
		<script type="text/javascript" src="js/clLib.UI.pageConfig.js"></script>
		<script type="text/javascript" src="js/clLib.REST.js"></script>
<!--		<script type="text/javascript" src="clLib.COMBINED.js"></script>-->

<!--
		<script type="text/javascript" src="sampledata/routeLogSample.js"></script>
		<script type="text/javascript" src="sampledata/routeSample_big.js"></script>
-->
<!--
		<script type="text/javascript" src="http://codeorigin.jquery.com/jquery-1.8.2.js"></script>
        <script type="text/javascript" src="http://codeorigin.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.js"></script>
-->
		<script type="text/javascript" src="js/jquery-1.8.2.js"></script>
        <script type="text/javascript" src="js/jquery.mobile-1.3.0.js"></script>

		<link rel="stylesheet" href="css/clLib.css" />
</head> 

<body> 

<div data-role="page" style="min-height:480px; max-width:600px;"  id="newRouteLog" class="type-interior"
        data-theme="a" data-add-back-btn="false" data-back-btn-text="Back">


	<div data-role="header" data-position="fixed" data-theme="a" id="newRouteLog_mobileheader1">
		<h1>
			New Route
		</h1>
		<!-- mobilebutton_229 -->
                <!-- preferencesButton -->
                <a data-role="button" name="preferencesButton" dsid="preferencesButton" class='ui-btn-right   startScreen_preferencesButton'
                style='min-height:20px; ' id="startScreen_preferencesButton" data-corners="true"
                data-icon="gear" data-iconpos="notext" x-apple-data-detectors="false" data-inline='true'
                data-mini='true' data-theme="a" tabindex="11">
                Button
                </a>
                <!-- refreshRouteStorageButton -->
                <a data-role="button" name="refreshRouteStorageButton" dsid="refreshRouteStorageButton"
                class='ui-btn-left   startScreen_refreshRouteStorageButton' style='min-height:20px; '
                id="startScreen_refreshRouteStorageButton" data-corners="true" data-icon="refresh"
                data-iconpos="notext" x-apple-data-detectors="false" data-inline='true' data-mini='true'
                data-theme="a" tabindex="5">
                Refresh!
                </a>
		<select>
			<option value="newRouteLog">newRouteLog</option>
			<option value="newRouteLog_reduced">newRouteLog_reduced</option>
		</select>

	</div>
            
			
	<div data-role="content" id="newRouteLog_mobilecontainer1"  data-theme="">

			<div data-role="none" id="newRouteLog_ratingSelectWrapper">
			asdfasfd
			</div>
			

				<div>
					<a id="addRouteButton" href="#"><img src="files/views/assets/image/add_button.png"/></a>
				</div>

				<!-- area -->
                <div>
                    <select  id="startScreen_areaSelect"  data-theme="a" 
                    
                    tabIndex="4">
<!--                
						<option value="" reRender="areaSelect"  selected="selected">
                            areaSelect
                        </option>
-->
					</select>
                </div>

				<div>
					<button id="refreshStartScreen">refresh local date..</button>
				</div>

                <div>
                    <table id="newRouteLog_mobilegrid_30"  
                     cellpadding=0 cellspacing=0 style="width: 100%"
					>
                        <col style="width:50%;" />
                        <col style="width:50%;" />
                        <tr>
                            <!-- grade_option_cell -->
                            <td>
                                    <!-- gradeTypeSelect -->
                                    <div>
                                        <select  id="newRouteLog_gradeTypeSelect" 
                                        data-theme="a" data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right"
                                        data-native-menu="true" tabIndex="16">
										</select>
                                    </div>
                            </td>
                            <!-- mobilegridcell_167 -->
                            <td>
                                    <!-- gradeSelect -->
                                    <div>
                                        <select  id="newRouteLog_gradeSelect" 
                                        data-theme="a" data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right"
                                        data-native-menu="true" tabIndex="2">
                                        </select>
                                    </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <!-- sectorSelect -->
                <div >
                    <select  id="newRouteLog_sectorSelect"  data-theme="a" data-inline="false"
                    data-mini="false" data-icon="arrow-d" data-iconpos="right" data-native-menu="true"
                    tabIndex="5">
                        <option value="" reRender="sectorSelect"  selected="selected">
                            sectorSelect
                        </option>
                    </select>
                </div>
                <!-- lineSelect -->
                <div >
                    <select  id="newRouteLog_lineSelect"  data-theme="a" data-inline="false"
                    data-mini="false" data-icon="arrow-d" data-iconpos="right" data-native-menu="true"
                    tabIndex="5">
                        <option value="" reRender="lineSelect"  selected="selected">
                            lineSelect
                        </option>
                    </select>
                </div>
                <!-- mobilegrid_217 -->
                <div>
                    <table style="width: 100%"
                     cellpadding=0 cellspacing=0>
                        <col style="width:50%;" />
                        <col style="width:50%;" />
                        <tr>
                            <!-- mobilegridcell_218 -->
                            <td
                            colspan=1 rowspan=1>
                                <div>
                                    <!-- ticktypes -->
                                    <div >
                                        <select  id="newRouteLog_tickType"  data-theme="a"
                                        data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" data-native-menu="true"
                                        tabIndex="3">
                                            <option value="" reRender="ticktypes"  selected="selected">
                                                Tick Type
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </td>
                            <!-- mobilegridcell_219 -->
                            <td
                            colspan=1 rowspan=1>
                                <div>
                                    <!-- colourSelect -->
                                    <div>
                                        <select  id="newRouteLog_colourSelect"  data-theme="a"
                                        data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" data-native-menu="false"
                                        tabIndex="6">
                                            <option value="" reRender="colourSelect"  selected="selected">
                                                Colour
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <!-- characterSelect -->
				<div >
					<select  id="newRouteLog_characterSelect"  data-theme="a"
					data-inline="false" data-mini="false" data-icon="arrow-d" data-iconpos="right" data-native-menu="false"
					tabIndex="6">
						<option value="" reRender="characterSelect"  selected="selected">
							character
						</option>
					</select>
				</div>

				<!-- searchRoute -->
                <div>
                    <div id="newRouteLog_searchRoute-cover-div">
                        <img id="newRouteLog_searchRoute-cover-img" src="files/resources/image/icon-search-cover.png"
                        />
                    </div>
                    <input type="search"  id="newRouteLog_searchRoute" 
                    value="" placeholder="Search Route Name" data-theme="a" tabIndex="7" 
                    />
                </div>
                <!-- searchRouteResults -->
                <ul data-role="listview" id="newRouteLog_searchRouteResults" 
                  data-inset="true" data-theme="d"
                data-divider-theme="b" data-count-theme="b" style="">
                    <!-- searchRouteResult -->
                    <li>
                        <a id="newRouteLog_searchRouteResult"  
                        tabIndex="18">
                        <h3>Item 1</h3>
                        </a>
                    </li>
                </ul>
                <!-- commentText -->
                <div>
                    <textarea  id="newRouteLog_commentText" tabIndex="9"
                     data-theme="a"></textarea>
                </div>
				
                <!-- save_tick -->
                <a data-role="button"   
                id="newRouteLog_save_tick" data-corners="true" data-icon="check" data-iconpos="right"
                data-mini="false" data-theme="a" tabIndex="8">
                Save Tick!
                </a>

		<div id="newRouteLog_routeLogContainer" style="margin: 0px 0px 0px 0px; padding: 0px 0px 0px 0px ;" data-role="collapsible-set" data-theme="b" data-content-theme="d">
				<div data-role="collapsible" data-collapsed="true">
					<h2 style="text-align: end">????</h2>
					<ul data-role="listview" data-theme="d" data-divider-theme="d">
					</ul>
				</div>
		</div>
				
	
		<input type="button" id="loadNewRouteLog" value="load newRouteLog elements"/>
		<input type="button" id="showpageloading" value="page loading"/>
	<input type="button" id="hidepageloading" value="no page loading"/>
				</div>
            <!-- mobilefooter1 -->
            <div data-role="footer" data-position="fixed" 
             id="newRouteLog_mobilefooter1" data-theme="a">
            </div>
        </div>
<script>
	"use strict";
	
	
	
(function(){
var printi = function(text) {
	$("<p>").html(text).appendTo("#foo");

};


$( document ).live("pageinit", function() {

		//alert("filling...");
		clLib.UI.buildRatingRadio($("#newRouteLog_ratingSelectWrapper"));

		clLib.UI.fillUIelements("startScreen", "startScreen");
		$("#startScreen_layoutSelect").val(localStorage.getItem("currentLayout"));
		$("#startScreen_layoutSelect").selectmenu("refresh");
		

		clLib.UI.fillUIelements("newRouteLog", "newRouteLog");

		//alert("filled...");
	});

$( document ).live("change.clLib", function(e) {
//		alert("changed..." + JSON.stringify($(e.target).attr("id")) + " with data " + JSON.stringify(e.data));
//		alert("2changed..." + JSON.stringify(e));
});
$( document ).bind("refresh.clLib", function(e, options) {
//		alert("refresh..." + JSON.stringify($(e.target).attr("id")) + " with options " + JSON.stringify(options));
//		alert("refreshed..." + JSON.stringify(e));
});

	$("#refreshStartScreen").click(function() {
		alert("previous refresh:" + clLib.localStorage.getLastRefreshDate("routeStorage"));
		
		var userRoutes = clLib.REST.getEntities("Routes");
		alert("GOT: "  + JSON.stringify(userRoutes));
		clLib.localStorage.initStorage("routeStorage", userRoutes);

		var userRouteLogs = clLib.REST.getEntities("RouteLog", clLib.getRouteLogWhereToday());
		alert("GOT: "  + JSON.stringify(userRouteLogs));
		clLib.localStorage.initStorage("routeLogStorage", userRouteLogs);
		alert("new refresh:" + clLib.localStorage.getLastRefreshDate("routeStorage"));

		clLib.UI.fillUIelements("startScreen", "startScreen");

	});


	$("#loadNewRouteLog").click(function() {
		clLib.UI.fillUIelements("newRouteLog", "newRouteLog");
	});
	$("#showpageloading").live("click", function() {
			$.mobile.loading( 'show', {
			text: 'foo',
			textVisible: true,
			//theme: 'z',
			//html: ""
		});
	});
	
	$("#hidepageloading").live("click", function() {
		$.mobile.hidePageLoadingMsg();
	});

	$("#newRouteLog_save_tick").bind("click.clLib", function(e) {
		//alert("SAVING!!!");
		localStorage.setItem("currentJqmSlide", "newRouteLog");
		localStorage.setItem("currentLayout", "default");
		clLib.UI.showLoading();

		clLib.UI.defaultSaveHandler();
/*
	var saveObj= {
			"Area": localStorage.getItem("currentlySelectedArea"),
			"GradeSystem": $("#newRouteLog_gradeTypeSelect").val(),
			"Grade": $("#newRouteLog_gradeSelect").val(),
			"Sector": $("#newRouteLog_sectorSelect").val(),
			"Colour": $("#newRouteLog_colourSelect").val(),
			"Line": $("#newRouteLog_lineSelect").val(),
			"TickType": $("#newRouteLog_tickType").val(),
			"RouteName": $("#newRouteLog_searchRoute").val(),
			"userName": localStorage.getItem("currentUser"),
			"Rating": $("#newRouteLog_ratingSelectRadio" + ":checked").val(),
			"Date": new Date()
		};
//		clLib.REST.storeEntity("RouteLog", saveObj);

		clLib.localStorage.addInstance("RouteLog", saveObj, "routeLogStorage");
*/

		clLib.UI.fillUIelements("startScreen", "startScreen");
		clLib.UI.resetUIelements("newRouteLog", "newRouteLog");
		clLib.UI.hideLoading();
	});

	$("#addRouteButton").bind("click", function(e) {
		//alert("resetting..");
		clLib.UI.resetUIelements("newRouteLog");
		//alert("resetted..");
	});

	$("#startScreen_layoutSelect").change(function() {
		var currentLayout = $(this).val();
		//alert("setting layout to>" + currentLayout);
		localStorage.setItem("currentLayout", currentLayout || "default");
		location.reload();
	});
	
//});		
})(jQuery);

   </script>
	
</body>

  
</html>