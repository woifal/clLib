<!DOCTYPE html> 
<html >

<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="no-cache"/>
    <meta http-equiv="Expires" content="-1"/>
    <meta http-equiv="Cache-Control" content="no-cache"/>

	<title>Kurt Climbing 0408a</title> 
	<link rel="stylesheet" href="http://www.kurt-climbing.com/Joomla/STATIC/css/THEMES/20140627/app1.css" />
	<link rel="stylesheet" href="http://www.kurt-climbing.com/Joomla/STATIC/css/THEMES/20140627/jquery.mobile.structure-1.4.2.css" />

    <link rel="stylesheet" href="../css/clRouteColors.css" />
    <link rel="stylesheet" href="../css/clLib.css" />


        <!-- phonegap integration? -->
        <script type="text/javascript" src="../js/jquery-1.8.2.js"></script>
        <script type="text/javascript" src="../js/Chart.js"></script>

		



        <script type="text/javascript" src="../js/clLib.js"></script>
        <script type="text/javascript" src="../js/clLib.auth.js"></script>
        <script type="text/javascript" src="../js/clLib.gradeConfig.js"></script>
        <script type="text/javascript" src="../js/clLib.localStorage.js"></script>
        <script type="text/javascript" src="../js/clLib.localStorage.indexes.js"></script>
        <script type="text/javascript" src="../js/clLib.UI.js"></script>
        <script type="text/javascript" src="../js/clLib.REST.js"></script>
<!--
        <script type="text/javascript" src="../js/clLib.PAGES.js"></script>
		
		<script type="text/javascript" src="../js/clLib.PAGES.web.js"></script>
-->	
        
		<script type="text/javascript" src="../js/clLib.IAP.js"></script>
        <script type="text/javascript" src="../js/clLib.UI.pageConfig.js"></script>

        <script type="text/javascript" src="../js/clLib.UI.web.GraphConfig.js"></script>
        <script type="text/javascript" src="../js/webClLib.js"></script>
		<style>
            ul#statsLinks { 
                list-style: none;
                padding: 10px 40px;
                margin: 0px 20px;
                font-weight: normal;
            }
            ul#statsLinks li a.active { 
                font-weight: bold;
            }
            ul#statsLinks li { 
                padding: 20px 0px;
                border: 0px solid red;
            }
        </style>
<script>
          
    $(document).ready(function() {
        $("#graphSelector").on("change", function(e) {
            //alert("getting stats for user >" + $("#usernameSelector").val() + "<");
            var newVal = $(this).val();
            setTimeout(
                function() { 
                    clLib.graphConfig["_routeLogConfig"].get(newVal).draw({
                        where: {
                            username: clLib.getUserInfo()["username"]
                        }
                    });
                },
                1
            );
            
        });
        
        $.each(clLib.graphConfig["_routeLogConfig"].graphs(), function(idx, graphName) {
            $("#graphSelector").append(
                "<option value='" + graphName + "'>" + graphName + "</option"
            );
        });

        $("#graphSelector").val("highScoreByDay");
        //$("#graphSelector").trigger("change");
        
        $.each(clLib.graphConfig["_routeLogConfig"].graphConfigs, function(idx, graphConfig) {
            $("#statsLinks").append(
                $("<li>").append(
                    $("<a>")
                        .data("graphName", graphConfig["graphName"])
                        .html(graphConfig.config["displayName"])
                )
            );
        });

        $("#statsLinks a").on("click", function(e) {
            var newVal = $(this).data("graphName");
            $(this).parents("ul").find("a").removeClass("active");
            $(this).addClass("active");
            console.log("getting stats >" + newVal + "<");
            
            setTimeout(
                function() { 
                    clLib.graphConfig["_routeLogConfig"].get(newVal).draw({
                        where: {
//                            username: $("#usernameSelector").val()
                            username: clLib.getUserInfo()["username"]

                        }
                    });
                },
                1
            );
            
        });
        
        $("#statsLinks a:eq(0)").trigger("click");
        

        
    });

</script>  
        
		</head> 


<body style="background-color: white !important;" >  
<input id="usernameSelector" type="text" style="display: none">
<select id="graphSelector" data-role="none" style="display: none;">
<!--
    <option value="allSessions">All Ssessions(bar)</option>
    <option value="allSessionsLine">All Sessions(line)</option>
-->
</select>
<div style="float: left">
    <ul id="statsLinks">
    </ul>
</div>
<div id="routeLogDiagramContainer" style="padding: 10px 40px; width: 100%; height: 400px; ">
<canvas class="clCanvas" width="800px" height="400px" style="border: 1px solid #CCCCCC; awidth: 300px; aheight: 300px;"></canvas>
</div>

</body>

</html>
